<html>
<head>
  <meta http-equiv="pragma" content="no-cache" />
  <meta http-equiv="expires" content="-1">

  <script src="promise-3.2.0.js"></script>
  <script src="three.min.js" type="text/javascript"></script>
  <script src="quadnet.js" type="text/javascript"></script>
  <script src="quadnet-setup.js" type="text/javascript"></script>
  <script src="3dobjects.js" type="text/javascript"></script>
</head>

<style>
body {
  margin: 0 0 0 0;
  overflow: hidden;
}
#quadnet, #canvas-container {
  width:100%;
  height:100%;
  background-color: black;
}

.quadnet-screen {position: absolute;top: 0; left: 0; width: 100%; height: 100%; font-family: sans-serif;}

#quadnet-hud {color: #0e0; font-size: 100%;}
#quadnet-hud .display, .label {font-size: 200%}
#quadnet-hud table .label {width: 200px}
#quadnet-hud table .content.score {width: 150px; text-align: right}

#quadnet-hud, #quadnet-welcome-screen, #quadnet-instructions-screen {display: none;}


#quadnet-welcome-screen, #quadnet-instructions-screen  {
  background-color: black;
  color: #ee9a12;
}

table {
  color: inherit;
}

p {
  font-family: sans-serif;
}

#quadnet-loading-screen {
  text-align: center;
  color: white;
  background: url('img/background.jpg');
  background-size:100% 100%;
}

#quadnet-loading-screen h1 {
  position: relative;
  top: 50%;
  font-family: sans-serif;
}


#quadnet-loading-screen #container {
    display: table;
    height: 100%;
    width: 100%;
    margin: 0;
    }

#quadnet-loading-screen #content {
    display: table-cell;
    vertical-align: middle;
    position: relative;
    }

#quadnet-loading-screen #inner {
    width: 50%;
    margin: 0 auto;
    padding: 0 20px;
    }

.centered-layer {
  text-align: center;
}

h1.quadnet-title {
  color: #080;
  font-size: 1500%;
  margin-top: 5%;
  margin-bottom: 0;
}

h2.press-enter {
  color: #fff;
  font-size: 300%;
  margin-top: 1%;
}

a {
  color: #0c0;
}

#quadnet-welcome-screen .centered-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

#quadnet-welcome-screen img.netimage {
  margin-left: auto;
  margin-right: auto;
  margin-top: 16%;
}

div.footer {
  height: auto;
  position: absolute;
  bottom: 0;
  width: 100%;
}

div.credits {
  text-align: left;
}

.footer table {
  font-size:150%;
  width: 100%;
}

table td.left-side {
  width: 50%;
}

table td.middle-side {
  text-align: right;
  width: 10%;
}

table td.right-side {
  text-align: right;
  width: 10%;
}

table td.right-side img {
  width: 45%;
}

#quadnet-instructions-screen table {
  width: 100%;
  height: 50%;
}

#quadnet-instructions-screen table tr {
  width: 100%;
  height: 100%;
}

#quadnet-instructions-screen table tr td.img-td {
  width: 30%;
  text-align: center;
}

#quadnet-instructions-screen table tr td.text-td {
  width: 20%;
  font-size: 300%;
}

#quadnet-instructions-screen table img {
  width: 80%;
}

.quadnet-screen {
  transition: all 0.5s ease-in-out;
}

.quadnet-screen.toup {
  top: -100%;
}

</style>
<body>
  <div id="quadnet">
    <div id="canvas-container">
    </div>
    <div id="quadnet-loading-screen" class="quadnet-screen">
      <div id="container">
        <div id="content">
          <div id="inner">        
            <h1>LOADING...</h1>
          </div><!-- fin inner -->
        </div><!-- fin content" -->
      </div>
    </div>

    <div id="quadnet-hud" class="quadnet-screen">
      <table>
        <tr><td class='label'>SCORE:</td><td class='content score'><div class='score-display display'>0</div></td></tr>
      </table>
    </div>

    <div id="quadnet-instructions-screen" class="quadnet-screen toup">
      <table>
        <tr>
          <td class="img-td">
            <img src="img/instr1.jpg"></img>
          </td>
          <td class="text-td">
            <p>Use arrow keys to move the ship in all four directions</p>
          </td>
          <td class="img-td">
            <img src="img/instr2.gif"></img>
          </td>
          <td class="text-td">
            <p>Use WASD to shoot in all four directions</p>
          </td>
        </tr>
      </table>
      <table>
        <tr>
          <td class="text-td">
            <p>Evade asteroids to avoid colliding with them</p>
          </td>
          <td class="img-td">
            <img src="img/instr3.jpg"></img>
          </td>
          <td class="text-td">
            <p>Shoot to destroy asteroids and earn points</p>
          </td>
          <td class="img-td">
            <img src="img/instr4.jpg"></img>
          </td>
        </tr>
      </table>
    </div>

    <div id="quadnet-welcome-screen" class="quadnet-screen toup">
      <div class="centered-layer">
        <img class="netimage" src="img/welcomenet.jpg"> </img>
      </div>
      <div class="centered-layer">
        <h1 class="quadnet-title">QUADNET</h1>
        <h2 class="press-enter"><a href="#">Press Enter to Play</a></h1>

        <div class="footer">
          <table>
            <thead>
            </thead>
            <tbody>
              <tr>
                <td class="left-side">
                  <div class="credits">Dario Seminara <br/>
                    <a href="http://github.com/tario/quadnet">http://github.com/tario/quadnet</a><br/>
                    Tribute to 1998's QUADNET <br/>
                    <a href="http://www.martinmagnusson.com/games/quadnet">http://www.martinmagnusson.com/games/quadnet</a>
                  </div>
                </td>
                <td class="middle-side">
                  Share this game with your friends!
                </td>
                <td class="right-side">
                  <img src="img/twitter-button.png"></img>
                  <img src="img/facebook-button.png"></img>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    
    </div>

  </div>
  <script type="text/javascript">
    window.onload= function(){
      var onGame = false;

      var launch = function() {
        activateScreen("#quadnet-hud");
        quadnet(document, document.getElementById("canvas-container"));
        onGame = true;
      };

      Quadnet.onStop(function(arguments) {
        onGame = false;
        activateScreen("#quadnet-welcome-screen");
      });

      var activateScreen = function(name) {
        // hide all screens

        var allScreens = document.querySelectorAll(".quadnet-screen");
        for (var i=0; i<allScreens.length; i++) {
          allScreens[i].style.display = "none";
        }

        document.querySelector(name).style.display = "inline";
        window.onkeydown = function(){};
        (document.querySelector(name).ondisplay || (function(){}) )();
      };

      document.querySelector("#quadnet-welcome-screen").ondisplay = function() {
        setTimeout(function() {
          document.querySelector("#quadnet-welcome-screen").classList.remove("toup");
        }, 0);
        window.onkeydown = function(e){
          if (e.keyCode === 13) {
            document.querySelector("#quadnet-instructions-screen").classList.add("toup");
            activateScreen("#quadnet-instructions-screen");
          };
        };
      };

      document.querySelector("#quadnet-instructions-screen").ondisplay = function() {
        setTimeout(function() {
          document.querySelector("#quadnet-instructions-screen").classList.remove("toup");
        }, 0);
        window.onkeydown = function(e){
          onGame = true;
          document.querySelector("#quadnet-instructions-screen").classList.add("toup");
          launch();
        };
      };

      Quadnet.prepareResources().then(function(){

        // this timeout simulates a delay on loading screen
        setTimeout(function() {
          document.querySelector(".press-enter a").onclick = function() {
            activateScreen("#quadnet-welcome-screen");
          };
          activateScreen("#quadnet-welcome-screen");
        },1000);
      });
    };
  </script>
</body>
</html>
